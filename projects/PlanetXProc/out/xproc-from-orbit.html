<?xml version="1.0" encoding="UTF-8"?><html xmlns="http://www.w3.org/1999/xhtml"><head><title>XProc from Orbit</title><style xml:space="preserve" type="text/css">

aside.fig_set { display: flex; gap: 0.7em;
    flex-flow: row wrap;
    align-items: flex-start; }

div.fig_block { flex: auto; max-width: fit-content;
  background-color: whitesmoke; border: medium solid midnightblue; padding: 0.3em;
  margin-top: 0.8em }

pre.eg { max-width: fit-content;
  background-color: white; border: thin inset steelblue; padding: 0.3em;
  margin-top: 0.8em }

p, ul { max-width: 54em }

      </style></head><body>
   <section>
      <h2>XProc from Orbit</h2>
      <p>From a height the broader outlines come into view.</p>
      <p>XProc is a data processing technology for digital data. While it is an XML-based technology using XML syntax, it can work with many kinds of data, including common text-based formats such as JSON.</p>
      <p>In XProc, information processing happens by means of <i>pipelines</i>. Expressed using XML format, an XProc pipeline is both a linguistic and computational artifact, and (in developers' minds) a discrete logical entity with an internal organization: a chain or branched structure.</p>
      <p>A pipeline combines a sequence or set of processes and applies them to specified inputs ("sources") to create outputs ("results").</p>
      <p>This makes XProc an appropriate technology for building and supporting complex workflows in document production, data conversion, and information exchange.</p>
      <section>
         <h3>Pipelines and steps</h3>
         <ul>
            <li>A pipeline is made of steps</li>
            <li>A pipeline can also be used as a step, when declared with or imported into another pipeline</li>
            <li>XProc defines libraries of standard, reusable steps for all processors, supporting many common operations</li>
            <li>You can also design and use new steps, in and with your own XProc</li>
         </ul>
         <aside class="fig_set"><div class="fig_block"><h4>Example <a href="src/starter.xpl">src/starter.xpl</a></h4>
            <pre class="eg">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;p:declare-step version="3.0" xmlns:p="http://www.w3.org/ns/xproc"&gt;
  &lt;!-- A pipeline is defined with p:declare-step --&gt;
  
  &lt;!-- First, reads a file from the file system --&gt;
  &lt;p:load href="../xproc-from-orbit.md" content-type="text/plain"/&gt;
  
  &lt;!-- Does its best to produce HTML from Markdown input --&gt;
  &lt;p:markdown-to-html/&gt;

  &lt;!-- Saves the result --&gt;
  &lt;p:store href="../out/xproc-from-orbit.html"/&gt;
  
&lt;/p:declare-step&gt;</pre>
         </div><div class="fig_block"><h4>Example <a href="src/refresh-xml.xpl">src/refresh-xml.xpl</a></h4>
            <p>Showing an imported step in a custom namespace</p>
            <pre class="eg">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;p:declare-step version="3.0"
  xmlns:p="http://www.w3.org/ns/xproc"
  xmlns:zone="http://wendellpiez.com/ns/xproc-zone"&gt;
  
  &lt;!--  Imports a pipeline (step declaration or library) --&gt;
  &lt;p:import href="_make-orbital-markup.xpl"/&gt;
  
  &lt;!-- Loads a file as plain text --&gt;
  &lt;p:load href="../xproc-from-orbit.md" content-type="text/plain"/&gt;
  
  &lt;!-- Makes HTML, if possible (supported in XML Calabash) --&gt;
  &lt;p:markdown-to-html/&gt;

  &lt;!-- Calls an imported step --&gt;
  &lt;zone:make-orbital-markup/&gt;
  
  &lt;!-- Saves the result --&gt;
  &lt;p:store href="../xproc-from-orbit.xml" message="SAVING xproc-from-orbit.xml ..."
    serialization="map { 'indent': true() }"/&gt;
  
&lt;/p:declare-step&gt;</pre>
         </div></aside>
         
      </section>
      <section>
         <h3>How to write a pipeline</h3>
         <p>An XProc pipeline takes the form of an arrangement of steps.</p>
         <aside class="fig_set"><div class="fig_block"><h4>Example <a href="src/moresteps.xpl">src/moresteps.xpl</a></h4>
            <pre class="eg">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;p:declare-step version="3.0" xmlns:p="http://www.w3.org/ns/xproc"&gt;
  
  &lt;!-- Reads a file as plain text --&gt;
  &lt;p:load href="../xproc-from-orbit.md" content-type="text/plain"/&gt;
  
  &lt;!-- If the processor supports the step, Markdown is converted to HTML --&gt;
  &lt;p:markdown-to-html/&gt;

  &lt;!-- Applying an XSLT transformation using the nominated stylesheet --&gt;
  &lt;p:xslt&gt;
    &lt;p:with-input port="stylesheet" href="xslt/html-resuscitate.xsl"/&gt;
  &lt;/p:xslt&gt;
  
  &lt;!-- Saves a file in the ../out folder --&gt;
  &lt;p:store href="../out/xproc-from-orbit.html"/&gt;
  
&lt;/p:declare-step&gt;</pre>
         </div></aside>
         <p>We say 'arrangement' here since steps can accommodate as many inputs and outputs as needed, connecting together.</p>
         <aside class="fig_set"><div class="fig_block"><h4>Example <a href="src/double-validate.xpl">src/double-validate.xpl</a></h4>
            <pre class="eg">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;p:declare-step version="3.0"
  xmlns:p="http://www.w3.org/ns/xproc"&gt;
  
  &lt;!-- Reads an XML document --&gt;
  &lt;p:load href="../out/xproc-from-orbit.xml"/&gt;
  
  &lt;!-- A validation step with two input ports,  'source' and 'schema'
       and two output ports, 'result' and 'report' --&gt;
  &lt;p:validate-with-relax-ng name="TEI-structures" assert-valid="false"&gt;
    &lt;p:with-input port="schema" href="schemas/orbital-promoted.rnc"/&gt;
  &lt;/p:validate-with-relax-ng&gt;
  
  &lt;!-- Another validation step with similar ports --&gt;
  &lt;p:validate-with-schematron name="other-regularities" assert-valid="false"&gt;
    &lt;p:with-input port="schema" href="schemas/orbital-stability.sch"/&gt;
  &lt;/p:validate-with-schematron&gt;
  
  &lt;p:wrap-sequence wrapper="VALIDATION-REPORTS"&gt;
    &lt;p:with-input&gt;
      &lt;!-- Connecting to the 'report' output ports from earlier steps --&gt;
      &lt;p:pipe port="report" step="TEI-structures"/&gt;
      &lt;p:pipe port="report" step="other-regularities"/&gt;
    &lt;/p:with-input&gt;
  &lt;/p:wrap-sequence&gt;
  
  &lt;!-- Saving the combined report --&gt;
  &lt;p:store href="../out/validation-reports.xml" serialization="map { 'indent': true() }"/&gt;

&lt;/p:declare-step&gt;</pre>
         </div></aside>
         <p>[Illustration: a more complex pipeline]</p>
      </section>
   </section>
   <section>
      <h2>XProc from Above</h2>
      <section>
         <h3>I/O, ports and documents</h3>
         <ul>
            <li>Pipelines, and steps, can accept one or more designated inputs, or none - they can accept inputs provided at runtime, or find and load data sources, or both</li>
            <li>Steps can also expose processing results as outputs, and also interact with your system, writing files on disk or communicating through other channels</li>
            <li>The connections that an XProc step exposes for data are called its <b>ports</b>
            </li>
            <li>By means of ports, we pass documents into steps and get documents out - and while XProc calls them <b>documents</b>, they can be any kind of data at all</li>
            <li>A pipeline can be defined with ports for connecting with other steps, when used as a step in another pipeline</li>
            <li>The <i>composability</i> of steps is key to the efficiency and power offered by XProc</li>
         </ul>
         <aside class="fig_set"><div class="fig_block"><h4>Example <a href="src/refresh-xml.xpl">src/refresh-xml.xpl</a></h4>
            <pre class="eg">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;p:declare-step version="3.0"
  xmlns:p="http://www.w3.org/ns/xproc"
  xmlns:zone="http://wendellpiez.com/ns/xproc-zone"&gt;
  
  &lt;!--  Imports a pipeline (step declaration or library) --&gt;
  &lt;p:import href="_make-orbital-markup.xpl"/&gt;
  
  &lt;!-- Loads a file as plain text --&gt;
  &lt;p:load href="../xproc-from-orbit.md" content-type="text/plain"/&gt;
  
  &lt;!-- Makes HTML, if possible (supported in XML Calabash) --&gt;
  &lt;p:markdown-to-html/&gt;

  &lt;!-- Calls an imported step --&gt;
  &lt;zone:make-orbital-markup/&gt;
  
  &lt;!-- Saves the result --&gt;
  &lt;p:store href="../xproc-from-orbit.xml" message="SAVING xproc-from-orbit.xml ..."
    serialization="map { 'indent': true() }"/&gt;
  
&lt;/p:declare-step&gt;</pre>
         </div><div class="fig_block"><h4>Example <a href="src/_make-orbital-markup.xpl">src/_make-orbital-markup.xpl</a></h4>
            <pre class="eg">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;p:declare-step version="3.0" xmlns:p="http://www.w3.org/ns/xproc"
 type="zone:make-orbital-markup"
 xmlns:zone="http://wendellpiez.com/ns/xproc-zone"&gt;
  
  &lt;!-- Accepts an XML (XHTML) document on 'source' port
       and creates a clean XML representation of the data set --&gt;
  
  &lt;p:input port="source"/&gt;
  
  &lt;p:output/&gt;
  
  &lt;p:xslt&gt;
    &lt;p:with-input port="stylesheet" href="xslt/html-resuscitate.xsl"/&gt;
  &lt;/p:xslt&gt;

  &lt;p:validate-with-relax-ng&gt;
    &lt;p:with-input port="schema"&gt;
      &lt;p:document href="schemas/orbital-promoted.rnc"/&gt;
    &lt;/p:with-input&gt;
  &lt;/p:validate-with-relax-ng&gt;

&lt;/p:declare-step&gt;</pre>
         </div></aside>
         
      </section>
      <section>
         <h3>Steps with implicit port connections</h3>
         <ul>
            <li>XProc syntax can be fairly concise and clean - at least, as XML-based formats go - because it has sensible fallback rules and some nice ways of keeping syntax simple.</li>
            <li>One consequence is that as long as steps in your pipeline are to be applied in sequence, we like to say they <i>snap together</i>.</li>
            <li>The XProc feature in play here is called the default readable port. The concept is simple. Any step with a primary input port that is not connected explicitly, will be bound to the primary output of the immediately preceding step.</li>
            <li>This works well, with the caveat that steps that have no input ports don't connect like this, even when given in sequence - and steps with no output ports can't be connected as inputs at all. Know your steps.</li>
         </ul>
         <p>[illustrations: three steps in sequence, with and without ports showing]</p>
         <aside class="fig_set"><div class="fig_block"><h4>Example <a href="src/moresteps.xpl">src/moresteps.xpl</a></h4>
            <pre class="eg">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;p:declare-step version="3.0" xmlns:p="http://www.w3.org/ns/xproc"&gt;
  
  &lt;!-- Reads a file as plain text --&gt;
  &lt;p:load href="../xproc-from-orbit.md" content-type="text/plain"/&gt;
  
  &lt;!-- If the processor supports the step, Markdown is converted to HTML --&gt;
  &lt;p:markdown-to-html/&gt;

  &lt;!-- Applying an XSLT transformation using the nominated stylesheet --&gt;
  &lt;p:xslt&gt;
    &lt;p:with-input port="stylesheet" href="xslt/html-resuscitate.xsl"/&gt;
  &lt;/p:xslt&gt;
  
  &lt;!-- Saves a file in the ../out folder --&gt;
  &lt;p:store href="../out/xproc-from-orbit.html"/&gt;
  
&lt;/p:declare-step&gt;</pre>
         </div><div class="fig_block"><h4>Example <a href="src/moresteps-explicit.xpl">src/moresteps-explicit.xpl</a></h4>
            <pre class="eg">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;p:declare-step version="3.0" xmlns:p="http://www.w3.org/ns/xproc"&gt;
  
  &lt;!-- Reads a file as plain text --&gt;
  &lt;p:load name="loading" href="../xproc-from-orbit.md" content-type="text/plain"/&gt;
  
  &lt;!-- If the processor supports the step, Markdown is converted to HTML --&gt;
  &lt;p:markdown-to-html name="making-html"&gt;
    &lt;p:with-input port="source"&gt;
      &lt;p:pipe port="result" step="loading"/&gt;
    &lt;/p:with-input&gt;
  &lt;/p:markdown-to-html&gt;

  &lt;!-- Applying an XSLT transformation using the nominated stylesheet --&gt;
  &lt;p:xslt name="transforming"&gt;
    &lt;p:with-input port="source"&gt;
      &lt;p:pipe port="result" step="making-html"/&gt;
    &lt;/p:with-input&gt;
    &lt;p:with-input port="stylesheet"&gt;
      &lt;p:document href="xslt/html-resuscitate.xsl"/&gt;
    &lt;/p:with-input&gt;
  &lt;/p:xslt&gt;
  
  &lt;p:store href="../out/xproc-from-orbit.xml"&gt;  
    &lt;p:with-input port="source"&gt;
      &lt;p:pipe port="result" step="transforming"/&gt;
    &lt;/p:with-input&gt;
  &lt;/p:store&gt;
  
&lt;/p:declare-step&gt;</pre>
         </div></aside>
         
      </section>
      <section>
         <h3>Knowing your formats</h3>
         <p>XProc comes with native support for XML and JSON reading and parsing, for plain text inputs, and for inputs defined with regular grammars using Invisible XML (ixml).</p>
         <p>All of these types of data, and others, can be passed from one step to another, as long as the step can accommodate the given format or media type.</p>
         <p>[illustration: a step showing some JSON]</p>
      </section>
      <section>
         <h3>Powerful embedded languages</h3>
         <p>XPath, XSLT and XQuery all play well with XProc, which is designed first and foremost to accommodate these kindred technologies.</p>
         <p>XProc steps can either invoke or embed instances of these declarative processing languages, or others.</p>
         <p>[illustration: a step showing some XQuery?]</p>
      </section>
      <section>
         <h3>Looking at those ports</h3>
         <p>Ports go in only one direction: they are input or output, never both. The <code>identity</code> step replicates its input on its output.</p>
         <p>The conventional name for the primary port is "source". The conventional name for the primary output port is "result". These names correspond with the uses of these terms in XSLT and XQuery.</p>
         <p>So every port with an input is likely to have a 'source', while every port with an output is likely to have its 'result'.</p>
         <p>It is sometimes useful for a step to have input but no output - <code>p:sink</code> being the simple example. A few steps have no inputs or outputs, but only effects in the system, such as <code>p:file-touch</code> or <code>file:mk-dir</code> (for making a directory).</p>
         <p>The 'source' and 'result' ports can carry sequences when the steps on which they are defined say so - and when permitted to be sequences they may also be empty (have no documents bound to them): a sequence with no members, not a single.</p>
         <p>Ports apart from 'source' and 'result' will be secondary, and will have names indicating their roles in the operation of their steps - a good example is a 'schema' secondary input port for a validation step, which a processor uses to provide the schema.</p>
      </section>
      <section>
         <h3>Options</h3>
         <p>In addition to inputs and outputs (connection ports), steps can also have <b>options</b>.</p>
         <p>These provide runtime configurations when invoking steps and pipelines.</p>
         <p>Their values can be simple (string value flags) or complex (such as map objects, or expressions to be evaluated).</p>
         <p>Its ports and options together provide an <i>interface</i> for using a step.</p>
         <p>Options can be set on steps using abbreviated syntax (attributes) or long syntax (<code>p:with-option</code>)</p>
         <p>[examples in both forms. including an XSLT parameters example]</p>
      </section>
      <section>
         <h3>Foundations of XProc</h3>
         <p>The more you know, the better you feel.</p>
         <ul>
            <li>XML syntax</li>
            <li>XML namespaces</li>
            <li>XPath (including XPath 3.0, 3.1) and XDM (XML Data Model)</li>
            <li>XSLT, XQuery</li>
            <li>REST and the web / URIs</li>
            <li>schema technologies, standard vocabularies, validation and workflow</li>
            <li>HTML/CSS/SVG, XSL-FO</li>
         </ul>
      </section>
      <section>
         <h3>Minimal XProc</h3>
         <p>If your skills include XSLT, this might be all you ever need in XProc:</p>
         <ul>
            <li>
               <code>p:variable</code>
            </li>
            <li>
               <code>p:load</code>
            </li>
            <li>
               <code>p:store</code>
            </li>
            <li>
               <code>p:xslt</code>
            </li>
            <li>
               <code>@serialization</code>
            </li>
            <li>
               <code>@message</code>
            </li>
         </ul>
         <p>Take another lesson on Day Two - learn to write a pipeline and use it as a step</p>
         <ul>
            <li>
               <code>p:declare-step</code>
            </li>
            <li>
               <code>p:input</code> (and <code>p:with-input</code>)</li>
            <li>
               <code>p:output</code>
            </li>
            <li>
               <code>p:option</code> and (<code>p:with-option</code>)</li>
            <li>
               <code>p:library</code>
            </li>
         </ul>
         <p>Three everyday utility steps</p>
         <ul>
            <li>
               <code>p:sink</code>
            </li>
            <li>
               <code>p:cast-content-type</code>
            </li>
            <li>
               <code>p:identity</code>
            </li>
         </ul>
         <p>
            Step list
         </p>
      </section>
   </section>
</body></html>